{
  "rules": {
    "posts": {
      ".read": true,
      "$postId": {
        ".write": "auth.uid === newData.child('author').child('uid').val() && !data.exists()" // Allow creates
      }
    },
    "comments": {
      ".read": true,
      "$postId": {
        ".validate": "root.child('posts').child($postId).exists()", // Check that the post exists
        "$commentId": {
          ".write": "(auth.uid === newData.child('author').child('uid').val() && !data.exists()) || (auth.uid === data.child('author').child('uid').val() && !newData.exists())"  // Can only create or delete comments if you are the author
        }
      }
    },
    "votes": {
      ".read": true,
      "$postId": {
        ".validate": "root.child('posts').child($postId).exists()", // Check that the post exists
        "$uid": {
          ".write": "auth.uid === $uid",
          ".validate": "newData.val() === now"
        }
      }
    },
    "people": {
      ".read": true,
      "$uid": {
        ".write": "auth.uid === $uid",
        "full_name": {
          ".validate": "newData.isString()"
        },
        "battletag": {
          ".validate": "newData.isString()"
        },
        "profile_picture": {
          ".validate": "newData.isString()"
        },
        "posts": {
          "$postId": {
            ".validate": "newData.val() === true && newData.parent().parent().parent().parent().child('posts').child($postId).exists()"
          }
        }
      }
    }
  }
}